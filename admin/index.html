<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Admin - Database Peserta</title>
    <!-- PASTIKAN library QRCode dimuat -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav>
        <a href="index.html" class="active">ðŸ“Š Data Peserta</a>
        <a href="scan.html">ðŸ“± Scan QR</a>
    </nav>

    <div class="container">
        <h2>Database Peserta (Realtime)</h2>
        <div class="controls">
            <input type="text" id="searchInput" placeholder="ðŸ” Cari nama/kode..." onkeyup="searchData()">
            <button id="btnSort" onclick="sortData()">ðŸ“Š Urutkan A-Z</button>
        </div>
        
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>QR Code</th>
                        <th>Kode</th>
                        <th>Nama</th>
                        <th>Nomor Tiket</th>
                        <th>Email</th>
                        <th>No HP</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- Data akan diisi oleh JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" style="display: flex; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.95); z-index: 9999; align-items: center; justify-content: center; flex-direction: column;">
        <div style="width: 60px; height: 60px; border: 5px solid #f3f3f3; border-top: 5px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite;"></div>
        <p style="margin-top: 20px; font-weight: 500; color: #333;">Memuat data peserta...</p>
    </div>

    <!-- Notification Toast -->
    <div id="toast" style="position: fixed; bottom: 20px; right: 20px; background: #333; color: white; padding: 16px 24px; border-radius: 8px; z-index: 1000; display: none; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
        <span id="toastMessage"></span>
    </div>

    <script type="module" src="script-admin.js"></script>
    
    <style>
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .qr-container canvas {
            display: block;
            margin: 0 auto;
        }
    </style>
    <script>
    // Fallback jika QRCode tidak terload
    if (typeof QRCode === 'undefined') {
        console.warn('QRCode library not loaded, retrying...');
        // Load library QRCode lagi
        const script = document.createElement('script');
        script.src = 'https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js';
        script.onload = function() {
            console.log('QRCode library loaded successfully');
        };
        document.head.appendChild(script);
    }
</script>
</body>
</html>